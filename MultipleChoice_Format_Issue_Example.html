<!doctype html>
<html>

<head>
  <title>Demo</title>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
    }

    .note {
      padding: 20px;
      background-color: lavenderblush;
    }

    .holder {
      display: flex;
    }
  </style>
    
	<script src="./shims/webcomponents.polyfill-loader.js"></script>
	<script type="text/javascript">

		if ((thisBrowserType() == "isFirefox") || thisBrowserType() == "isEdge") {

			loadJS('./shims/custom-elements.min.js');
			loadJS('./shims/native-shim.js');

		}
		else if (thisBrowserType() == "isChrome" || thisBrowserType() == "isSafari") {
			loadJS('./shims/webcomponents-loader.js')			
		}

		loadJS('./shims/custom-event-polyfill.js')

	</script>
	
</head>

<body>
  <p>
    This is an example of initializing a pie item using the files generated by pie pack.
    <div class="note">
      This must be run via a http server, not using the file system.
    </div>
  </p>
  <!-- Uncomment below div to see Multiple choice element -->
  <div class="mc">
    <div>
      <input type="submit" value="submit" />
    </div>
    <table>
      <tr>
        <td style="width:70%">
          <multiple-choice-configure pie-id="1"></multiple-choice-configure>
        </td>
        <td style="width:2%;background-color:#eee"></td>
        <td style="vertical-align:top">
          <div>STUDENT VIEW
            <span id="check-answer">Check Answer</span>
          </div>
          <multiple-choice pie-id="1"> </multiple-choice>
        </td>
      </tr>
    </table>
  </div>
  <!-- Multiple choice element end -->
  <script src="./jquery-1.11.1.min.js"></script>
  <script src="./main.js" defer></script>
  <!-- MC related js -->
  <script src="./pie/pie-configure.js" defer></script>
  <script src="./pie/pie-controllers.js" defer></script>
  <script src="./pie/pie-view.js" defer></script>
  <script type="text/javascript" defer>

    document.addEventListener('DOMContentLoaded', () => {

      document.querySelector("#check-answer").addEventListener('click', () => {
        env = { mode: 'evaluate' }
        const s = window.session.find(s => s.id === "1");
        window['pie-controller-pie-item']["multiple-choice"].model(window.mcModel, s, env)
          .then(uiModel => {

            const id = "1";
            let a = "multiple-choice[pie-id='" + id + "']";
            let el = document.querySelector(a);
            el.model = uiModel;
          })
      })
    })
    $.getJSON("./mc/format.json", function (data) {
      data.models.forEach((val) => {
        const model = val;

        window.mcModel = model;
        renderPIE(window.mcModel, 'multiple-choice');
      });
    });
  </script>
  <!-- -->
</body>

</html>